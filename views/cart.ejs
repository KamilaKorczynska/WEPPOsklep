<%- include('header') %>

<h1>Twój Koszyk</h1>

<% if (locals.message) { %>
    <div class="error-message">
        <%= locals.message %>
    </div>
<% } %>

<div class="cart-container">
    <% if (!cartItems || cartItems.length === 0) { %>
        <p>Twój koszyk jest pusty.</p>
    <% } else { %>
        <ul>
            <% cartItems.forEach(item => { %>
                <li>
                    <strong><%= item.name %></strong> - <%= item.quantity %> szt.
                    (Cena: <%= item.price %> zł)
                    
                    <% if (item.error) { %>
                        <p class="error-message"><%= item.error %></p>
                    <% } %>

                    <div class="cart-actions">
                        <form action="/cart/update" method="POST" style="display:inline;">
                            <input type="hidden" name="cartItemId" value="<%= item.id %>">
                            <input type="number" name="quantity" min="1" value="<%= item.quantity %>" required>
                            <button type="submit">Zaktualizuj</button>
                        </form>
                        <form action="/cart/remove" method="POST" style="display:inline;">
                            <input type="hidden" name="cartItemId" value="<%= item.id %>">
                            <button type="submit">Usuń</button>
                        </form>
                    </div>
                </li>
            <% }) %>
        </ul>
        <p><strong>Łączna cena: 
            <%= cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0) %> zł</strong>
        </p>
    <% } %>
</div>


<style>
    .cart-container {
        max-width: 600px;
        margin: 20px auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    h1 {
    text-align: center;
    color: #333;
    }
    ul {
        list-style: none;
        padding: 0;
    }
    li {
        margin-bottom: 10px;
    }
    button {
        background-color: #e74c3c;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 5px 10px;
        cursor: pointer;
    }
    button:hover {
        background-color: #c0392b;
    }
    .add-to-cart-btn {
        background-color: #2ecc71;  
    }

    .add-to-cart-btn:hover {
        background-color: #27ae60;
    }

    
    .edit-btn {
        background-color: #3498db;
    }

    .edit-btn:hover {
        background-color: #2980b9;
    }

    .delete-btn {
        background-color: #e74c3c;
        border: none;
    }

    .delete-btn:hover {
        background-color: #c0392b;
    }

    .add-to-cart-btn {
        background-color: #2ecc71;  
    }

    .add-to-cart-btn:hover {
        background-color: #27ae60;
    }

    .error-message {
    background-color: #ff4d4d;
    color: white;
    padding: 12px;
    margin-bottom: 15px;
    border-radius: 6px;
    text-align: center;
    font-weight: bold;
    font-size: 14px;
    box-shadow: 0 2px 10px rgba(255, 77, 77, 0.3);
    animation: fadeIn 0.5s ease-in-out;
    }



    @keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
    }

</style>